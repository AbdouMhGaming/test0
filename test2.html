<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Device Fingerprinting for Multi-Account Detection</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        table {
            width: 80%;
            margin: 20px auto;
            border-collapse: collapse;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        th, td {
            padding: 12px;
            border: 1px solid #ddd;
            text-align: left;
        }
        th {
            background-color: #4CAF50;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        .loading {
            text-align: center;
            font-style: italic;
            color: #777;
        }
        .warning {
            color: red;
            font-weight: bold;
        }
        .input-section {
            text-align: center;
            margin-bottom: 20px;
        }
        input, button {
            padding: 8px;
            margin: 5px;
        }
    </style>
</head>
<body>
    <h1>Device Fingerprinting & Multi-Account Detection</h1>
    <div class="input-section">
        <label for="accountId">Enter Account ID: </label>
        <input type="text" id="accountId" placeholder="e.g., user123">
        <button onclick="registerAccount()">Register Account</button>
    </div>
    <table id="infoTable">
        <thead>
            <tr>
                <th>Property</th>
                <th>Value</th>
            </tr>
        </thead>
        <tbody id="tableBody">
            <tr>
                <td colspan="2" class="loading">Loading device information...</td>
            </tr>
        </tbody>
    </table>

    <script>
        // Simple hash function for fingerprinting
        function hashString(str) {
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                hash = ((hash << 5) - hash) + str.charCodeAt(i);
                hash = hash & hash;
            }
            return Math.abs(hash).toString(16);
        }

        // Generate device fingerprint
        function generateFingerprint() {
            // Collect browser and device properties
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            ctx.textBaseline = 'top';
            ctx.font = '14px Arial';
            ctx.fillText('fingerprint', 2, 2);
            const canvasData = canvas.toDataURL();

            const properties = [
                navigator.userAgent,
                navigator.language,
                screen.width + 'x' + screen.height,
                screen.colorDepth,
                new Date().getTimezoneOffset(),
                navigator.hardwareConcurrency || 0,
                navigator.deviceMemory || 0,
                canvasData,
                // WebGL info (for additional uniqueness)
                (() => {
                    try {
                        const gl = document.createElement('canvas').getContext('webgl');
                        if (!gl) return '';
                        return gl.getParameter(gl.RENDERER) + gl.getParameter(gl.VENDOR);
                    } catch (e) {
                        return '';
                    }
                })()
            ].join('|');

            return hashString(properties);
        }

        // Fetch public IP address
        async function getPublicIP() {
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                return data.ip || 'Unable to fetch IP';
            } catch (error) {
                return 'Error fetching IP';
            }
        }

        // Simulate backend storage with localStorage (replace with real database in production)
        function getStoredAccounts() {
            return JSON.parse(localStorage.getItem('accounts') || '{}');
        }

        function saveAccount(accountId, fingerprint, ip) {
            const accounts = getStoredAccounts();
            if (!accounts[accountId]) {
                accounts[accountId] = { fingerprint, ip, timestamp: new Date().toISOString() };
                localStorage.setItem('accounts', JSON.stringify(accounts));
            }
        }

        // Check for multi-account usage
        function checkMultiAccount(fingerprint, currentAccountId) {
            const accounts = getStoredAccounts();
            const matchingAccounts = Object.keys(accounts).filter(
                id => accounts[id].fingerprint === fingerprint && id !== currentAccountId
            );
            return matchingAccounts.length > 0
                ? `Warning: Multiple accounts detected (${matchingAccounts.join(', ')})`
                : 'No multi-account issues';
        }

        // Display device info and multi-account status
        async function displayDeviceInfo(accountId = 'N/A') {
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = ''; // Clear loading message

            const fingerprint = generateFingerprint();
            const ip = await getPublicIP();
            const multiAccountStatus = checkMultiAccount(fingerprint, accountId);

            const systemInfo = {
                'Account ID': accountId,
                'Device Fingerprint': fingerprint,
                'Public IP Address': ip,
                'Operating System': navigator.platform,
                'Browser': navigator.userAgent,
                'Screen Resolution': `${screen.width}x${screen.height}`,
                'CPU Cores': navigator.hardwareConcurrency || 'Unknown',
                'Multi-Account Status': multiAccountStatus
            };

            for (const [key, value] of Object.entries(systemInfo)) {
                const row = document.createElement('tr');
                row.innerHTML = `<td>${key}</td><td class="${key === 'Multi-Account Status' && value.includes('Warning') ? 'warning' : ''}">${value}</td>`;
                tableBody.appendChild(row);
            }
        }

        // Register an account
        function registerAccount() {
            const accountId = document.getElementById('accountId').value.trim();
            if (!accountId) {
                alert('Please enter an Account ID');
                return;
            }
            const fingerprint = generateFingerprint();
            getPublicIP().then(ip => {
                saveAccount(accountId, fingerprint, ip);
                displayDeviceInfo(accountId);
            });
        }

        // Initial load
        window.onload = () => displayDeviceInfo();
    </script>
</body>
</html>
